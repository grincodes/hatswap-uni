import{a as d,b}from"./chunk-7QSHLNBW.js";import{ChainId as s}from"sushi/chain";var C=[s.BASE,s.OPTIMISM,s.BSC,s.THUNDERCORE,s.POLYGON,s.METIS,s.POLYGON_ZKEVM,s.ARBITRUM,s.CELO,s.AVALANCHE],ot=C,P=t=>C.includes(t),x={[s.BASE]:"0x16BA7102271dC83Fff2f709691c2B601DAD7668e",[s.OPTIMISM]:"0x7c464A0AB1f5ebf3E2dCccfec7EF41D02ED7a2f4",[s.BSC]:"0xe240B9a2936f6Fb8860219bC059349e50F03492e",[s.THUNDERCORE]:"0xab36D30C1A1C683037Bd7AAC67f29B2e3ECC6576",[s.POLYGON]:"0x29E1888F7DD0757f2873E494463Ec389dab38D27",[s.METIS]:"0x806c2240793b3738000fcb62C66BF462764B903F",[s.POLYGON_ZKEVM]:"0xcA19bEc25A41443F35EeAE03411Dce87D8c0Edc4",[s.ARBITRUM]:"0x806c2240793b3738000fcb62C66BF462764B903F",[s.CELO]:"0xdca3251Ebe8f85458E8d95813bCb816460e4bef1",[s.AVALANCHE]:"0x5D8249e3F5f702e1Fd720167b40424fc2daDCd1e"};import{erc20Abi as y}from"sushi/abi";import{getChainIdAddressFromId as A}from"sushi/format";function E({account:t,vaultIds:e}){return e.map(r=>{let{chainId:n,address:a}=A(r);return{abi:y,chainId:n,address:a,args:[t],functionName:"balanceOf"}})}async function T({client:t,account:e,vaultIds:r}){return(await t.multicall({allowFailure:!0,contracts:E({account:e,vaultIds:r})})).flatMap((a,i)=>typeof a.result>"u"?[]:G(r[i],a.result))}function G(t,e){return{vaultId:t,balance:e}}async function ut({client:t,account:e,vaultId:r}){let n=await T({client:t,account:e,vaultIds:[r]});if(!n[0])throw new Error(`Failed to fetch balance of for vault ${r}`);return n[0].balance}import{fetch as R}from"@whatwg-node/fetch";import{isPromiseFulfilled as w}from"sushi/validate";async function V({payloadHashes:t}){return(await Promise.allSettled(t.map(async r=>R(`https://ipfs.io/ipfs/${r}`).then(n=>n.json())))).map(r=>w(r)?r.value:null)}async function mt({payloadHash:t}){let e=await V({payloadHashes:[t]});if(!e[0])throw new Error(`Failed to fetch payload for hash ${t}`);return e[0]}import{fetch as k}from"@whatwg-node/fetch";import{isPromiseFulfilled as B}from"sushi";import{getChainIdAddressFromId as F}from"sushi/format";async function m(t,e,r){let n=`https://ro81h8hq6b.execute-api.us-east-1.amazonaws.com/pool/fee-apr?address=${e}&chain=${t}`;return r&&(n+=`&interval=${r}`),k(n).then(a=>a.json()).then(a=>a?.apr)}async function D({vaultIds:t}){return(await Promise.allSettled(t.map(async r=>{let{address:n,chainId:a}=F(r),i=await Promise.all([m(a,n),m(a,n,86400),m(a,n,604800)]);if(i.some(o=>typeof o>"u"))throw new Error("Couldn't fetch APR");let[l,u,c]=i.map(o=>Number(o)/100);return{apr:l,apr1d:u,apr1w:c}}))).map(r=>B(r)?r.value:null)}async function Pt({vaultId:t}){let e=await D({vaultIds:[t]});if(!e[0])throw new Error(`Failed to fetch APR for vault ${t}`);return e[0]}import{erc20Abi as M}from"sushi/abi";import{getChainIdAddressFromId as O}from"sushi/format";function N({vaultIds:t}){return t.map(e=>{let{chainId:r,address:n}=O(e);return{abi:M,chainId:r,address:n,functionName:"totalSupply"}})}async function $({client:t,vaultIds:e}){return(await t.multicall({allowFailure:!0,contracts:N({vaultIds:e})})).flatMap((n,a)=>typeof n.result>"u"?[]:_(e[a],n.result))}function _(t,e){return{vaultId:t,totalSupply:e}}async function St({client:t,vaultId:e}){let r=await $({client:t,vaultIds:[e]});if(!r[0])throw new Error(`Failed to fetch total supply for vault ${e}`);return r[0].totalSupply}import{fetch as U}from"@whatwg-node/fetch";import{isPromiseFulfilled as H}from"sushi";import{getChainIdAddressFromId as L}from"sushi/format";async function Y(t,e){let r=`https://ro81h8hq6b.execute-api.us-east-1.amazonaws.com/pool/apr/historical?address=${e}&chain=${t}`;return U(r).then(n=>n.json()).then(n=>n?.data)}async function j({vaultIds:t}){return(await Promise.allSettled(t.map(async r=>{let{address:n,chainId:a}=L(r);return Y(a,n)}))).map(r=>H(r)?r.value:null)}async function Gt({vaultId:t}){let e=await j({vaultIds:[t]});if(!e[0])throw new Error(`Failed to fetch APR timeseries for vault ${t}`);return e[0]}import{getChainIdAddressFromId as W}from"sushi/format";async function q({client:t,vaultIds:e}){return(await t.multicall({allowFailure:!0,contracts:e.map(n=>{let{chainId:a,address:i}=W(n);return{abi:d,chainId:a,address:i,functionName:"maxTickChange"}})})).flatMap((n,a)=>typeof n.result>"u"?[]:z(e[a],n.result))}function z(t,e){return{vaultId:t,maxTickChange:e}}async function kt({client:t,vaultId:e}){let r=await q({client:t,vaultIds:[e]});if(!r[0])throw new Error(`Failed to fetch max tick change for vault ${e}`);return r[0]}import{getChainIdAddressFromId as K}from"sushi/format";function Z({vaultIds:t}){return t.map(e=>{let{chainId:r,address:n}=K(e);return{abi:d,chainId:r,address:n,functionName:"getPositions"}})}async function J({client:t,vaultIds:e}){return(await t.multicall({allowFailure:!0,contracts:Z({vaultIds:e})})).flatMap((n,a)=>typeof n.result>"u"?[]:Q(e[a],n.result))}function Q(t,e){let r=e[0],n=e[1],a=e[2];return r.map((i,l)=>({vaultId:t,lowerTick:BigInt(r[l].toString()),upperTick:BigInt(n[l].toString()),relativeWeight:BigInt(a[l].toString())}))}async function Mt({client:t,vaultId:e}){return await J({client:t,vaultIds:[e]})}import{getChainIdAddressFromId as X}from"sushi/format";function tt({vaultIds:t}){return t.map(e=>{let{chainId:r,address:n}=X(e);if(!P(r))throw new Error(`Invalid chainId: ${r}`);let a=x[r];return{abi:b,address:a,chainId:r,args:[n],functionName:"vaultBalancesByAddressWithFees"}})}async function et({client:t,vaultIds:e}){return(await t.multicall({allowFailure:!0,contracts:tt({vaultIds:e})})).map((n,a)=>typeof n.result>"u"?null:rt(e[a],n.result))}function rt(t,e){return{vaultId:t,reserve0:e.amountToken0,reserve1:e.amountToken1}}async function Ut({client:t,vaultId:e}){let r=await et({client:t,vaultIds:[e]});if(!r[0])throw new Error(`Failed to fetch reserves for vaultId: ${e}`);return r[0]}import{getAddress as I}from"viem";async function Xt({vault:t,prices:e}){let r=e[I(t.token0.address)]||0,n=e[I(t.token1.address)]||0,a=Number(t.reserve0)/10**t.token0.decimals,i=Number(t.reserve1)/10**t.token1.decimals,l=a*r,u=i*n,c=l+u;if(c===0)return{token0:0,token1:0};let[o,p]=[l/c,u/c];return o=o<1e-5?0:Math.min(o,1),p=p<1e-5?0:Math.min(p,1),{token0:o,token1:p}}import{getChainIdAddressFromId as nt}from"sushi/format";function at({accountBalances:t,totalSupplies:e,vaultReserves:r}){if(t.length!==e.length||t.length!==r.length)throw new Error("accountBalances, totalSupplies, and vaultReserves must be the same length");return t.map(a=>a.vaultId).flatMap(a=>{let i=t.find(f=>f.vaultId===a),l=e.find(f=>f.vaultId===a),u=r.find(f=>f.vaultId===a);if(!i||!l||!u)return[];let c=i.balance,o=l.totalSupply,p=u,g=0n,h=0n;o!==0n&&(g=p.reserve0*c/o,h=p.reserve1*c/o);let{address:v,chainId:S}=nt(a);return{id:a,address:v,chainId:S,steerTokenSupply:o,steerTokenBalance:c,token0Balance:g,token1Balance:h}})}async function re({vaultId:t,accountBalance:e,totalSupply:r,vaultReserves:n}){return at({accountBalances:[{vaultId:t,balance:e}],totalSupplies:[{vaultId:t,totalSupply:r}],vaultReserves:[{vaultId:t,...n}]})[0]}export{x as STEER_PERIPHERY_ADDRESS,C as STEER_SUPPORTED_CHAIN_IDS,ot as SteerChainIds,re as getAccountPosition,at as getAccountPositions,ut as getBalanceOf,T as getBalanceOfs,E as getBalanceOfsContracts,G as getBalanceOfsSelect,Gt as getSteerVaultAprTimeseries,V as getStrategiesPayloads,mt as getStrategyPayload,Xt as getTokenRatios,$ as getTotalSupplies,N as getTotalSuppliesContracts,_ as getTotalSuppliesSelect,St as getTotalSupply,Pt as getVaultAprs,kt as getVaultMaxTickChange,Mt as getVaultPositions,Z as getVaultPositionsContracts,Ut as getVaultReserves,j as getVaultsAprTimeseries,D as getVaultsAprs,q as getVaultsMaxTickChanges,z as getVaultsMaxTickChangesSelect,Q as getVaultsPositionSelect,J as getVaultsPositions,et as getVaultsReserves,tt as getVaultsReservesContracts,rt as getVaultsReservesSelect,P as isSteerChainId};
//# sourceMappingURL=index.js.map